env:
  - name: POSH_THEME
    value: https://raw.githubusercontent.com/harrhp/configuration/HEAD/shell/custom.omp.json
  - name: GIT_SSH
    value: C:\Program Files\OpenSSH\ssh.exe
    persist: true
    if: match .OS "windows"
  - name: WSLENV
    value: GIT_SSH/p
    persist: true
    if: match .OS "windows"
  - name: BROWSER
    value: wslview
    if: hasCommand "wslview"
script:
  - value: |
      oh-my-posh init pwsh | Invoke-Expression
      Set-PSReadLineOption -BellStyle None -PredictionViewStyle ListView;
      Remove-Alias -Name h -ErrorAction SilentlyContinue;
      $env:Path = @($env:Path) + (Get-ChildItem -Path $env:LOCALAPPDATA\Microsoft\WinGet\Links\ | select -ExpandProperty Target | Split-Path -Parent | select -Unique) | Join-String -Separator ";"
    if: match .Shell "pwsh"
  - value: |
      eval "$(oh-my-posh init bash)"
    if: match .Shell "bash"
path:
  - value: |
      {{ .Home }}{{ if eq .OS "windows" }}\{{ else }}/{{ end }}bin
    persist: true
alias:
  - name: p
    value: push origin HEAD
    type: git
  - name: pf
    value: "!git add . && git commit --amend --no-edit && git push origin HEAD --force"
    type: git
  - name: db
    value: "!basename $(git symbolic-ref refs/remotes/origin/HEAD)"
    type: git
  - name: pl
    value: "!git pull origin $(git branch --show-current)"
    type: git
  - name: plr
    value: "!git pl --rebase"
    type: git
  - name: fd
    value: "!git fetch origin $(git db):$(git db)"
    type: git
  - name: rdb
    value: "!git fd && git rebase $(git db)"
    type: git
  - name: mdb
    value: "!git fd && git merge $(git db)"
    type: git
  - name: s
    value: status
    type: git
  - name: d
    value: diff -w -U0
    type: git
  - name: ds
    value: diff --staged -w -U0
    type: git
  - name: dss
    value: diff --shortstat
    type: git
  - name: dns
    value: diff --numstat
    type: git
  - name: co
    value: checkout
    type: git
  - name: codb
    value: "!git checkout $(git db)"
    type: git
  - name: cob
    value: checkout -b
    type: git
  - name: z
    value: "!git checkout . && git clean -fd"
    type: git
  - name: zs
    value: "!git z && git reset --hard"
    type: git
  - name: a
    value: add
    type: git
  - name: aa
    value: add .
    type: git
  - name: c
    value: "!f(){ git commit -m $1; }; f"
    type: git
  - name: ca
    value: commit --amend --no-edit
    type: git
  - name: cae
    value: commit --amend
    type: git
  - name: b
    value: branch
    type: git
  - name: bd
    value: branch -D
    type: git
  - name: lg
    value: log --graph --pretty=format:"%C(bold red)%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold yellow)<%an>%Creset" --abbrev-commit --date=relative
    type: git
  - name: sync-fork
    value: "!git fetch upstream $(git db) && git checkout $(git db) && git merge upstream/$(git db)"
    type: git
  - name: x
    value: "update-index --chmod=+x"
    type: git
  - name: grep
    value: Select-String
    type: command
    if: match .OS "windows"
  - name: Kek
    type: function
    if: match .Shell "pwsh"
    value: |
      $wshell = New-Object -ComObject wscript.shell;
      while ($true) {
          $wshell.SendKeys("{NUMLOCK}");
          $wshell.SendKeys("{NUMLOCK}");
          Start-Sleep -Seconds 60;
      }
  - name: h
    type: function
    if: match .Shell "pwsh"
    value: Get-Content (Get-PSReadlineOption).HistorySavePath
